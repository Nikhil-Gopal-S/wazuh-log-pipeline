# =============================================================================
# Fail2ban Filter: Bad Requests (400)
# =============================================================================
# Detects clients sending malformed requests (potential fuzzing/scanning)
# Matches Nginx JSON log format (security_json from logging.conf)
#
# JSON log example:
# {"timestamp":"2026-01-29T10:00:00Z","remote_addr":"192.168.1.100",
#  "request_method":"POST","request_uri":"/ingest","status":400,...}
# =============================================================================

[Definition]

# Match 400 Bad Request responses
failregex = ^.*"remote_addr":"<HOST>".*"status":\s*400\b.*$

# Ignore legitimate cases (if any)
ignoreregex =

# Date pattern for ISO 8601 timestamps in JSON logs
datepattern = "timestamp":"%%Y-%%m-%%dT%%H:%%M:%%S